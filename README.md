### GGRN: benchmarking across a Grammar of Gene Regulatory Network inference methods 

This repo contains tools for benchmarking various strategies for predicting in detail the outcome of perturbation experiments. For more context, see the [project summary](https://docs.google.com/document/d/1vvZi5c0nU3VTvKiWpEka8AtDORxJ3Ymv0ZzoFQwoDoI/edit).

### Experiments

The benchmarks in this project are composed of small, structured folders called Experiments. Code and metadata supporting each Experiment resides in a folder in `experiments`, and experiments can be run via `run_experiments.sh` or `do_one_experiment.py`. The most important parts of each Experiment are:

- `outputs`: these results are auto-generated by our software based on user input and our data collections.
- `metadata.json`: A complete specification of the experiment, provided by the user. We do not have a formal specification for the metadata yet, but validation and default-setting are done using a function from this repo's [companion package](https://github.com/ekernf01/perturbation_benchmarking_package). The most important information in the metadata is:
    - An explanatory "README" field describing the purpose of the experiment
    - The question it addresses (from `guiding_questions.txt`)
    - ONE associated perturbation dataset (from the perturbation dataset repo)
    - ONE OR MORE associated networks (from the network collection repo)

### Narrative

It can be hard to understand how all these experiments relate to one another, software-wise or science-wise. Run `gather_experiment_metadata.py` to produce a quick summary table describing all experiments. 

### Installation

The project is written in Python with the main dependencies being gseapy, DCD-FG, scanpy + AnnData, DuckDB, PyTorch, and the usuals (joblib, numpy, pandas, scipy, etc). We use Conda to manage the environment, except for specific dependencies of PRESCIENT. The environment can be exactly reproduced via the commands below. This requires a linux64 system (we use Ubuntu 20.04). 

```bash
conda create --name ggrn --file spec_file.txt
pip install cell-gears # hopefully we can condify this. Status: build complete, awaiting upload.
pip install celloracle # hopefully we can condify this. Status: build is buggy (gimmemotifs problem). 
pip install prescient --no-deps # Don't usurp the existing torch installation
pip install geomloss==0.2.3
```

**TO DO: explain how to install our packages** Our experiments rely on [adjacent repos](https://github.com/ekernf01/perturbation_writing) for network modeling and for quick loading of network structures and perturbation data. 

